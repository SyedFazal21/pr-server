const a0_0x3690bd=a0_0x21d0;function a0_0x2f01(){const _0x313b7f=['1695288QawBSs','oxylabUser','Server\x20error.','&password=','370570DlKYlP','express','9920mrxteI','Error\x20getting\x20original\x20IP:','body','status','get','bcrypt','1086oLcypr','External\x20API\x20error:','save','48FbCFsQ','/login','oxylabpass','../models/User','24097uMbcjK','User\x20not\x20registered\x20in\x20PR\x20solutions\x20contact\x20admin','Error\x20getting\x20proxy\x20IP:','84658YLPKFH','27aNAsyu','findOne','Failed\x20to\x20detect\x20IP\x20address','/register','Username\x20already\x20exists.','Router','Invalid\x20Oxylabs\x20credentials.','hash','json','data','us-pr.oxylabs.io:10000','https://sapivi.com/checkCredentails.php?username=','error','304948YWwACI','exports','External\x20credential\x20validation\x20failed','1280238XJCbZa','axios','https://api.ipify.org?format=json','post'];a0_0x2f01=function(){return _0x313b7f;};return a0_0x2f01();}(function(_0x5dbe3c,_0x583d08){const _0x20000f=a0_0x21d0,_0x27d7d2=_0x5dbe3c();while(!![]){try{const _0x4e8f38=parseInt(_0x20000f(0x79))/0x1+-parseInt(_0x20000f(0x8a))/0x2+parseInt(_0x20000f(0x8d))/0x3+parseInt(_0x20000f(0x91))/0x4+-parseInt(_0x20000f(0x97))/0x5*(parseInt(_0x20000f(0x72))/0x6)+parseInt(_0x20000f(0x7c))/0x7*(parseInt(_0x20000f(0x75))/0x8)+parseInt(_0x20000f(0x7d))/0x9*(-parseInt(_0x20000f(0x95))/0xa);if(_0x4e8f38===_0x583d08)break;else _0x27d7d2['push'](_0x27d7d2['shift']());}catch(_0x26a741){_0x27d7d2['push'](_0x27d7d2['shift']());}}}(a0_0x2f01,0x4f380));function a0_0x21d0(_0x114433,_0x19899e){const _0x2f0108=a0_0x2f01();return a0_0x21d0=function(_0x21d0fb,_0x5a0150){_0x21d0fb=_0x21d0fb-0x71;let _0x1cb745=_0x2f0108[_0x21d0fb];return _0x1cb745;},a0_0x21d0(_0x114433,_0x19899e);}const express=require(a0_0x3690bd(0x96)),bcrypt=require(a0_0x3690bd(0x71)),User=require(a0_0x3690bd(0x78)),axios=require(a0_0x3690bd(0x8e)),HttpsProxyAgent=require('https-proxy-agent'),router=express[a0_0x3690bd(0x82)]();router['post'](a0_0x3690bd(0x80),async(_0x33722a,_0x287db7)=>{const _0x4a3af0=a0_0x3690bd;try{const {username:_0x1e0de6,password:_0x435d2c,oxylabsUsername:_0x28025b,oxylabsPassword:_0x29d8fc}=_0x33722a[_0x4a3af0(0x99)];if(!_0x1e0de6||!_0x435d2c)return _0x287db7['status'](0x190)['json']({'success':![],'message':'All\x20fields\x20are\x20required.'});const _0x5f0c72=await User[_0x4a3af0(0x7e)]({'username':_0x1e0de6});if(_0x5f0c72)return _0x287db7[_0x4a3af0(0x9a)](0x199)['json']({'success':![],'message':_0x4a3af0(0x81)});try{const _0x2ef96c=_0x4a3af0(0x88)+encodeURIComponent(_0x1e0de6)+_0x4a3af0(0x94)+encodeURIComponent(_0x435d2c),_0xd6ae51=await axios[_0x4a3af0(0x9b)](_0x2ef96c);if(_0xd6ae51&&_0xd6ae51[_0x4a3af0(0x86)]&&!_0xd6ae51[_0x4a3af0(0x86)][_0x4a3af0(0x9a)])return _0x287db7[_0x4a3af0(0x9a)](0x191)[_0x4a3af0(0x85)]({'success':![],'message':'User\x20not\x20registered\x20in\x20PR\x20solutions\x20contact\x20admin'});}catch(_0x1cea2a){return console[_0x4a3af0(0x89)](_0x4a3af0(0x73),_0x1cea2a),_0x287db7[_0x4a3af0(0x9a)](0x191)[_0x4a3af0(0x85)]({'success':![],'message':'External\x20credential\x20validation\x20failed'});}if(_0x28025b&&_0x29d8fc){const _0x56354c=_0x4a3af0(0x87),[_0xb7e6bd,_0x3d5748]=_0x56354c['split'](':'),_0x5b6913=await getCurrentIp();if(!_0x5b6913)return _0x287db7['status'](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20detect\x20IP\x20address'});const _0xbb3787=await getProxyIp(_0xb7e6bd,_0x3d5748,_0x28025b,_0x29d8fc);if(!_0xbb3787)return _0x287db7[_0x4a3af0(0x9a)](0x190)[_0x4a3af0(0x85)]({'success':![],'message':_0x4a3af0(0x83)});_0x5b6913===_0xbb3787&&_0x287db7[_0x4a3af0(0x9a)](0x190)[_0x4a3af0(0x85)]({'success':![],'message':_0x4a3af0(0x83)});}const _0x488ca6=await bcrypt[_0x4a3af0(0x84)](_0x435d2c,0xa),_0x47f8fb=new User({'username':_0x1e0de6,'password':_0x488ca6,'oxylabsUsername':_0x28025b,'oxylabsPassword':_0x29d8fc});await _0x47f8fb[_0x4a3af0(0x74)](),_0x287db7[_0x4a3af0(0x85)]({'success':!![]});}catch(_0x5e33cd){console['error']('Register\x20error:',_0x5e33cd),_0x287db7[_0x4a3af0(0x9a)](0x1f4)[_0x4a3af0(0x85)]({'success':![],'message':_0x4a3af0(0x93)});}}),router[a0_0x3690bd(0x90)](a0_0x3690bd(0x76),async(_0x5bd77c,_0x4975b0)=>{const _0x2a3cd0=a0_0x3690bd;try{const {username:_0xc92bf8,password:_0x3fef40}=_0x5bd77c['body'],_0x4088f8='https://sapivi.com/checkCredentails.php?username='+encodeURIComponent(_0xc92bf8)+_0x2a3cd0(0x94)+encodeURIComponent(_0x3fef40),_0x5b4894=await axios['get'](_0x4088f8);if(_0x5b4894&&_0x5b4894[_0x2a3cd0(0x86)]&&!_0x5b4894[_0x2a3cd0(0x86)][_0x2a3cd0(0x9a)])return _0x4975b0[_0x2a3cd0(0x9a)](0x191)['json']({'success':![],'message':_0x2a3cd0(0x7a)});if(_0x5b4894[_0x2a3cd0(0x86)][_0x2a3cd0(0x92)]&&_0x5b4894['data']['oxylabpass']){const _0x425164=_0x2a3cd0(0x87),[_0x50df3a,_0x40a142]=_0x425164['split'](':'),_0x25a92e=await getCurrentIp();if(!_0x25a92e)return _0x4975b0['status'](0x1f4)[_0x2a3cd0(0x85)]({'success':![],'message':_0x2a3cd0(0x7f)});const _0x1a295c=await getProxyIp(_0x50df3a,_0x40a142,_0x5b4894[_0x2a3cd0(0x86)][_0x2a3cd0(0x92)],_0x5b4894[_0x2a3cd0(0x86)][_0x2a3cd0(0x77)]);if(!_0x1a295c)return _0x4975b0[_0x2a3cd0(0x9a)](0x190)[_0x2a3cd0(0x85)]({'success':![],'message':_0x2a3cd0(0x83)});_0x25a92e===_0x1a295c&&_0x4975b0['status'](0x190)[_0x2a3cd0(0x85)]({'success':![],'message':'Invalid\x20Oxylabs\x20credentials.'});}else _0x4975b0[_0x2a3cd0(0x9a)](0x190)[_0x2a3cd0(0x85)]({'success':![],'message':'Oxylabs\x20credentials\x20not\x20configured.'});return _0x4975b0[_0x2a3cd0(0x85)]({'success':!![],'oxylabsUsername':_0x5b4894['data'][_0x2a3cd0(0x92)],'oxylabsPassword':_0x5b4894[_0x2a3cd0(0x86)][_0x2a3cd0(0x77)]});}catch(_0x2d1e5b){return console['error']('External\x20API\x20error:',_0x2d1e5b),_0x4975b0[_0x2a3cd0(0x9a)](0x1f4)['json']({'success':![],'message':_0x2a3cd0(0x8c)});}});async function getCurrentIp(){const _0x5e55a8=a0_0x3690bd;try{const _0x470e78=await axios['get'](_0x5e55a8(0x8f),{'timeout':0x1388});return _0x470e78['data']['ip'];}catch(_0x431ef1){return console[_0x5e55a8(0x89)](_0x5e55a8(0x98),_0x431ef1),null;}}async function getProxyIp(_0x585a7e,_0x631313,_0xe0c841,_0x162f09){const _0xf1a9af=a0_0x3690bd;try{const _0x2ae9a9='http://'+_0xe0c841+':'+_0x162f09+'@'+_0x585a7e+':'+_0x631313,_0x3620e0=new HttpsProxyAgent(_0x2ae9a9),_0x25c8af=await axios['get'](_0xf1a9af(0x8f),{'httpsAgent':_0x3620e0,'timeout':0x2710});return _0x25c8af[_0xf1a9af(0x86)]['ip'];}catch(_0x181beb){return console[_0xf1a9af(0x89)](_0xf1a9af(0x7b),_0x181beb),null;}}module[a0_0x3690bd(0x8b)]=router;