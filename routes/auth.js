const a0_0xa39b87=a0_0x51a6;(function(_0x949e78,_0x48735d){const _0x5af7a4=a0_0x51a6,_0x403df9=_0x949e78();while(!![]){try{const _0x5f2c3c=-parseInt(_0x5af7a4(0x84))/0x1+parseInt(_0x5af7a4(0x97))/0x2*(-parseInt(_0x5af7a4(0x8d))/0x3)+parseInt(_0x5af7a4(0x99))/0x4+-parseInt(_0x5af7a4(0x7b))/0x5+parseInt(_0x5af7a4(0x91))/0x6+parseInt(_0x5af7a4(0x9b))/0x7*(parseInt(_0x5af7a4(0x73))/0x8)+parseInt(_0x5af7a4(0x7f))/0x9;if(_0x5f2c3c===_0x48735d)break;else _0x403df9['push'](_0x403df9['shift']());}catch(_0x56f0c6){_0x403df9['push'](_0x403df9['shift']());}}}(a0_0xee3f,0xa589b));function a0_0xee3f(){const _0xcf7475=['express','get','Register\x20error:','/register','2827955AUWwox','Invalid\x20Oxylabs\x20credentials.','/login','us-pr.oxylabs.io:10000','17453961vyTTRK','findOne','External\x20API\x20error:','https://sapivi.com/checkCredentails.php?username=','bcrypt','1063792uPJDdT','hash','oxylabsPassword','Username\x20already\x20exists.','error','body','User\x20not\x20registered\x20in\x20PR\x20solutions\x20contact\x20admin','Login\x20error:','Server\x20error.','4269nvGTDV','data','axios','All\x20fields\x20are\x20required.','567582DQYXxv','split','status','exports','&password=','json','154IPKBfV','Invalid\x20credentials','306012JDfRCV','External\x20credential\x20validation\x20failed','268247BxlRVM','http://','post','https://api.ipify.org?format=json','compare','64IFfAnU','save','password','Error\x20getting\x20original\x20IP:'];a0_0xee3f=function(){return _0xcf7475;};return a0_0xee3f();}function a0_0x51a6(_0x41f117,_0x2a65c6){const _0xee3fce=a0_0xee3f();return a0_0x51a6=function(_0x51a6e1,_0x1f53e6){_0x51a6e1=_0x51a6e1-0x73;let _0x5dd73e=_0xee3fce[_0x51a6e1];return _0x5dd73e;},a0_0x51a6(_0x41f117,_0x2a65c6);}const express=require(a0_0xa39b87(0x77)),bcrypt=require(a0_0xa39b87(0x83)),User=require('../models/User'),axios=require(a0_0xa39b87(0x8f)),HttpsProxyAgent=require('https-proxy-agent'),router=express['Router']();router[a0_0xa39b87(0x9d)](a0_0xa39b87(0x7a),async(_0x317f9c,_0x5c3ee2)=>{const _0x1a265a=a0_0xa39b87;try{const {username:_0x4d244a,password:_0x395803,oxylabsUsername:_0x49330c,oxylabsPassword:_0x203a2d}=_0x317f9c['body'];if(!_0x4d244a||!_0x395803)return _0x5c3ee2[_0x1a265a(0x93)](0x190)[_0x1a265a(0x96)]({'success':![],'message':_0x1a265a(0x90)});const _0x28bc1c=await User[_0x1a265a(0x80)]({'username':_0x4d244a});if(_0x28bc1c)return _0x5c3ee2[_0x1a265a(0x93)](0x199)[_0x1a265a(0x96)]({'success':![],'message':_0x1a265a(0x87)});try{const _0x49ee2c=_0x1a265a(0x82)+encodeURIComponent(_0x4d244a)+_0x1a265a(0x95)+encodeURIComponent(_0x395803),_0x58a4aa=await axios[_0x1a265a(0x78)](_0x49ee2c);if(_0x58a4aa&&_0x58a4aa[_0x1a265a(0x8e)]&&!_0x58a4aa[_0x1a265a(0x8e)][_0x1a265a(0x93)])return _0x5c3ee2[_0x1a265a(0x93)](0x191)[_0x1a265a(0x96)]({'success':![],'message':_0x1a265a(0x8a)});}catch(_0x89ec3b){return console[_0x1a265a(0x88)](_0x1a265a(0x81),_0x89ec3b),_0x5c3ee2[_0x1a265a(0x93)](0x191)['json']({'success':![],'message':_0x1a265a(0x9a)});}if(_0x49330c&&_0x203a2d){const _0x4330e5=_0x1a265a(0x7e),[_0x369b6b,_0x5b785a]=_0x4330e5[_0x1a265a(0x92)](':'),_0x43065c=await getCurrentIp();if(!_0x43065c)return _0x5c3ee2[_0x1a265a(0x93)](0x1f4)[_0x1a265a(0x96)]({'success':![],'message':'Failed\x20to\x20detect\x20IP\x20address'});const _0x26a5ef=await getProxyIp(_0x369b6b,_0x5b785a,_0x49330c,_0x203a2d);if(!_0x26a5ef)return _0x5c3ee2[_0x1a265a(0x93)](0x190)[_0x1a265a(0x96)]({'success':![],'message':_0x1a265a(0x7c)});_0x43065c===_0x26a5ef&&_0x5c3ee2['status'](0x190)[_0x1a265a(0x96)]({'success':![],'message':'Invalid\x20Oxylabs\x20credentials.'});}const _0x2cc5fd=await bcrypt[_0x1a265a(0x85)](_0x395803,0xa),_0x1604aa=new User({'username':_0x4d244a,'password':_0x2cc5fd,'oxylabsUsername':_0x49330c,'oxylabsPassword':_0x203a2d});await _0x1604aa[_0x1a265a(0x74)](),_0x5c3ee2[_0x1a265a(0x96)]({'success':!![]});}catch(_0x1360a8){console[_0x1a265a(0x88)](_0x1a265a(0x79),_0x1360a8),_0x5c3ee2['status'](0x1f4)['json']({'success':![],'message':'Server\x20error.'});}}),router[a0_0xa39b87(0x9d)](a0_0xa39b87(0x7d),async(_0x4b4c79,_0x23bc02)=>{const _0x41127f=a0_0xa39b87;try{const {username:_0x1bcbef,password:_0x561538}=_0x4b4c79[_0x41127f(0x89)],_0x980669=await User[_0x41127f(0x80)]({'username':_0x1bcbef});if(!_0x980669)return _0x23bc02[_0x41127f(0x93)](0x191)[_0x41127f(0x96)]({'success':![],'message':_0x41127f(0x98)});try{const _0x3f9cdf=_0x41127f(0x82)+encodeURIComponent(_0x1bcbef)+_0x41127f(0x95)+encodeURIComponent(_0x561538),_0x3a4dee=await axios[_0x41127f(0x78)](_0x3f9cdf);if(_0x3a4dee&&_0x3a4dee['data']&&!_0x3a4dee['data'][_0x41127f(0x93)])return _0x23bc02['status'](0x191)[_0x41127f(0x96)]({'success':![],'message':_0x41127f(0x8a)});}catch(_0x32cd57){return console[_0x41127f(0x88)](_0x41127f(0x81),_0x32cd57),_0x23bc02[_0x41127f(0x93)](0x191)[_0x41127f(0x96)]({'success':![],'message':_0x41127f(0x9a)});}const _0x51e76b=await bcrypt[_0x41127f(0x9f)](_0x561538,_0x980669[_0x41127f(0x75)]);if(!_0x51e76b)return _0x23bc02['status'](0x191)[_0x41127f(0x96)]({'success':![],'message':'Invalid\x20credentials'});_0x23bc02['json']({'success':!![],'oxylabsUsername':_0x980669['oxylabsUsername'],'oxylabsPassword':_0x980669[_0x41127f(0x86)]});}catch(_0x4b7df6){console['error'](_0x41127f(0x8b),_0x4b7df6),_0x23bc02[_0x41127f(0x93)](0x1f4)[_0x41127f(0x96)]({'success':![],'message':_0x41127f(0x8c)});}});async function getCurrentIp(){const _0x51be65=a0_0xa39b87;try{const _0x358d77=await axios['get'](_0x51be65(0x9e),{'timeout':0x1388});return _0x358d77[_0x51be65(0x8e)]['ip'];}catch(_0x3c0883){return console[_0x51be65(0x88)](_0x51be65(0x76),_0x3c0883),null;}}async function getProxyIp(_0x149995,_0x539aa1,_0x5190cc,_0x32b863){const _0x348eff=a0_0xa39b87;try{const _0x188263=_0x348eff(0x9c)+_0x5190cc+':'+_0x32b863+'@'+_0x149995+':'+_0x539aa1,_0x4b0e41=new HttpsProxyAgent(_0x188263),_0x156918=await axios[_0x348eff(0x78)](_0x348eff(0x9e),{'httpsAgent':_0x4b0e41,'timeout':0x2710});return _0x156918[_0x348eff(0x8e)]['ip'];}catch(_0x515864){return console[_0x348eff(0x88)]('Error\x20getting\x20proxy\x20IP:',_0x515864),null;}}module[a0_0xa39b87(0x94)]=router;