const a0_0x2d7803=a0_0x2a97;(function(_0x42d226,_0x585680){const _0x919785=a0_0x2a97,_0xe0b557=_0x42d226();while(!![]){try{const _0x5f41f2=parseInt(_0x919785(0x20b))/0x1+-parseInt(_0x919785(0x1d2))/0x2*(parseInt(_0x919785(0x200))/0x3)+-parseInt(_0x919785(0x1f1))/0x4*(-parseInt(_0x919785(0x1fc))/0x5)+-parseInt(_0x919785(0x1d5))/0x6*(-parseInt(_0x919785(0x1e5))/0x7)+parseInt(_0x919785(0x202))/0x8*(-parseInt(_0x919785(0x206))/0x9)+parseInt(_0x919785(0x1ee))/0xa+parseInt(_0x919785(0x204))/0xb;if(_0x5f41f2===_0x585680)break;else _0xe0b557['push'](_0xe0b557['shift']());}catch(_0x27cb39){_0xe0b557['push'](_0xe0b557['shift']());}}}(a0_0x3928,0xdd288));function a0_0x2a97(_0x4fdf01,_0xead73d){const _0x3928ed=a0_0x3928();return a0_0x2a97=function(_0x2a97fb,_0x77cb45){_0x2a97fb=_0x2a97fb-0x1c6;let _0x21f632=_0x3928ed[_0x2a97fb];return _0x21f632;},a0_0x2a97(_0x4fdf01,_0xead73d);}const express=require(a0_0x2d7803(0x1f6)),axios=require(a0_0x2d7803(0x20c)),HttpsProxyAgent=require(a0_0x2d7803(0x1cd)),User=require(a0_0x2d7803(0x20a)),router=express['Router']();function a0_0x3928(){const _0x238b63=['pe-pr.oxylabs.io','get','https://api.ipify.org?format=json','random','https://api.myip.com','jp-pr.oxylabs.io','br-pr.oxylabs.io','Failed\x20to\x20connect\x20through\x20proxy.\x20Invalid\x20credentials\x20or\x20proxy\x20server\x20unavailable.','ph-pr.oxylabs.io','/user-info','es-pr.oxylabs.io','match','in-pr.oxylabs.io','split','4501SKQsKE','save','/rotate-oxylabs-ip','pl-pr.oxylabs.io','error','status','body','Missing\x20required\x20fields','nl-pr.oxylabs.io','4662070tuVVLb','http://ip-api.com/json/','json','1149128IfUynP','tw-pr.oxylabs.io','Failed\x20to\x20detect\x20original\x20IP\x20address','sg-pr.oxylabs.io','floor','express','tr-pr.oxylabs.io','pt-pr.oxylabs.io','ca-pr.oxylabs.io','Error\x20getting\x20proxy\x20IP:','Failed\x20to\x20fetch\x20user\x20info','5vgiKYs','Invalid\x20country\x20format.\x20Expected\x20format:\x20\x22host:port\x22','th-pr.oxylabs.io','mx-pr.oxylabs.io','180933dGvwqH','kr-pr.oxylabs.io','1104EIBYSW','us-pr.oxylabs.io','11169532wZOkCN','ru-pr.oxylabs.io','53631ObxcnC','ua-pr.oxylabs.io','my-pr.oxylabs.io','oxylabsUsername','../models/User','252739lgDGly','axios','gr-pr.oxylabs.io','pk-pr.oxylabs.io','us-pr.oxylabs.io:10000','de-pr.oxylabs.io','oxylabsPassword','Error\x20getting\x20original\x20IP:','message','https-proxy-agent','http://','ae-pr.oxylabs.io','data','ir-pr.oxylabs.io','26sBrSXS','Unsupported\x20or\x20invalid\x20country\x20code','Failed\x20to\x20fetch\x20user\x20info:\x20','4578lJDQxo','be-pr.oxylabs.io'];a0_0x3928=function(){return _0x238b63;};return a0_0x3928();}router['post']('/validate-oxylabs',async(_0x2fe8a8,_0x5d02b3)=>{const _0x422d78=a0_0x2d7803,{oxylabsUsername:_0x239622,oxylabsPassword:_0x397751,username:_0x50d5b8}=_0x2fe8a8[_0x422d78(0x1eb)];if(!_0x239622||!_0x397751)return _0x5d02b3['json']({'valid':![],'message':'Missing\x20credentials'});const _0x6fb64e=_0x422d78(0x1c8),[_0x2801ae,_0x275831]=_0x6fb64e[_0x422d78(0x1e4)](':');if(!_0x2801ae||!_0x275831||isNaN(_0x275831))return _0x5d02b3[_0x422d78(0x1ea)](0x190)[_0x422d78(0x1f0)]({'valid':![],'error':_0x422d78(0x1fd)});const _0xf53bf7=await getCurrentIp();if(!_0xf53bf7)return _0x5d02b3['status'](0x1f4)[_0x422d78(0x1f0)]({'valid':![],'error':_0x422d78(0x1f3)});const _0x39327d=await getProxyIp(_0x2801ae,_0x275831,_0x239622,_0x397751);if(!_0x39327d)return _0x5d02b3[_0x422d78(0x1ea)](0x191)[_0x422d78(0x1f0)]({'valid':![],'error':_0x422d78(0x1de)});const _0x45a511=_0xf53bf7!==_0x39327d,_0x18c998=await User['findOne']({'username':_0x50d5b8});return _0x45a511&&_0x18c998?(_0x18c998[_0x422d78(0x209)]=_0x239622,_0x18c998[_0x422d78(0x1ca)]=_0x397751,await _0x18c998[_0x422d78(0x1e6)](),_0x5d02b3[_0x422d78(0x1f0)]({'valid':!![]})):_0x5d02b3[_0x422d78(0x1f0)]({'valid':![],'message':'User\x20not\x20found'});}),router[a0_0x2d7803(0x1d8)](a0_0x2d7803(0x1e0),async(_0x2fd8e,_0x4e8a09)=>{const _0x2e87e=a0_0x2d7803;try{const _0x1d2e69=await fetch(_0x2e87e(0x1ef));data=await _0x1d2e69[_0x2e87e(0x1f0)]();if(!data||!data['ip']){const _0x4971f6=await fetch(_0x2e87e(0x1d9));data=await _0x4971f6['json']();}if(!data||!data['ip']){const _0x217f33=await fetch(_0x2e87e(0x1db));data=await _0x217f33['json']();}if(data&&data['ip']){const {query:_0x5b980d,country:_0x1bbcc7,city:_0x5e34e,regionName:_0x6551ee}=_0x1d2e69[_0x2e87e(0x1d0)];return _0x4e8a09[_0x2e87e(0x1f0)]({'ip':_0x5b980d,'country':_0x1bbcc7,'city':_0x5e34e,'region':_0x6551ee});}else return _0x4e8a09['json']({'error':_0x2e87e(0x1fb)});}catch(_0x4c1ca4){return _0x4e8a09['json']({'error':_0x2e87e(0x1d4)+_0x4c1ca4[_0x2e87e(0x1cc)]});}});async function getCurrentIp(){const _0x13583e=a0_0x2d7803;try{const _0x52df6e=await axios[_0x13583e(0x1d8)](_0x13583e(0x1d9),{'timeout':0x1388});return _0x52df6e['data']['ip'];}catch(_0x1b871e){return console[_0x13583e(0x1e9)](_0x13583e(0x1cb),_0x1b871e),null;}}async function getProxyIp(_0x54caa5,_0x17a796,_0x26cea5,_0x3c9cfe){const _0x42e740=a0_0x2d7803;try{const _0xaf5f9e=_0x42e740(0x1ce)+_0x26cea5+':'+_0x3c9cfe+'@'+_0x54caa5+':'+_0x17a796,_0x13dfb5=new HttpsProxyAgent(_0xaf5f9e),_0x110a96=await axios[_0x42e740(0x1d8)](_0x42e740(0x1d9),{'httpsAgent':_0x13dfb5,'timeout':0x2710});return _0x110a96[_0x42e740(0x1d0)]['ip'];}catch(_0x4204f8){return console[_0x42e740(0x1e9)](_0x42e740(0x1fa),_0x4204f8),null;}}const countryPortRanges={'us':{'host':a0_0x2d7803(0x203),'min':0x2711,'max':0x4e1f},'ca':{'host':a0_0x2d7803(0x1f9),'min':0x7531,'max':0x9c3f},'gb':{'host':'gb-pr.oxylabs.io','min':0x4e21,'max':0x752f},'de':{'host':a0_0x2d7803(0x1c9),'min':0x7531,'max':0x9c3f},'fr':{'host':'fr-pr.oxylabs.io','min':0x9c41,'max':0xc34f},'es':{'host':a0_0x2d7803(0x1e1),'min':0x2711,'max':0x4e1f},'it':{'host':'it-pr.oxylabs.io','min':0x4e21,'max':0x752f},'se':{'host':'se-pr.oxylabs.io','min':0x7531,'max':0x9c3f},'gr':{'host':a0_0x2d7803(0x1c6),'min':0x9c41,'max':0xc34f},'pt':{'host':a0_0x2d7803(0x1f8),'min':0x2711,'max':0x4e1f},'nl':{'host':a0_0x2d7803(0x1ed),'min':0x4e21,'max':0x752f},'be':{'host':a0_0x2d7803(0x1d6),'min':0x7531,'max':0x9c3f},'ru':{'host':a0_0x2d7803(0x205),'min':0x9c41,'max':0xc34f},'ua':{'host':a0_0x2d7803(0x207),'min':0x2711,'max':0x4e1f},'pl':{'host':a0_0x2d7803(0x1e8),'min':0x4e21,'max':0x752f},'il':{'host':'il-pr.oxylabs.io','min':0x4e21,'max':0x752f},'tr':{'host':a0_0x2d7803(0x1f7),'min':0x7531,'max':0x9c3f},'au':{'host':'au-pr.oxylabs.io','min':0x9c41,'max':0xc34f},'my':{'host':a0_0x2d7803(0x208),'min':0x2711,'max':0x4e1f},'th':{'host':a0_0x2d7803(0x1fe),'min':0x4e21,'max':0x752f},'kr':{'host':a0_0x2d7803(0x201),'min':0x7531,'max':0x9c3f},'jp':{'host':a0_0x2d7803(0x1dc),'min':0x9c41,'max':0xc34f},'ph':{'host':a0_0x2d7803(0x1df),'min':0x2711,'max':0x4e1f},'sg':{'host':a0_0x2d7803(0x1f4),'min':0x4e21,'max':0x752f},'cn':{'host':'cn-pr.oxylabs.io','min':0x7531,'max':0x9c3f},'hk':{'host':'hk-pr.oxylabs.io','min':0x9c41,'max':0xc34f},'tw':{'host':a0_0x2d7803(0x1f2),'min':0x2711,'max':0x4e1f},'in':{'host':a0_0x2d7803(0x1e3),'min':0x4e21,'max':0x752f},'pk':{'host':a0_0x2d7803(0x1c7),'min':0x7531,'max':0x9c3f},'id':{'host':'id-pr.oxylabs.io','min':0x2711,'max':0x4e1f},'ir':{'host':a0_0x2d7803(0x1d1),'min':0x2711,'max':0x4e1f},'az':{'host':'az-pr.oxylabs.io','min':0x4e21,'max':0x752f},'ae':{'host':a0_0x2d7803(0x1cf),'min':0x7531,'max':0x9c3f},'kz':{'host':'kz-pr.oxylabs.io','min':0x9c41,'max':0xc34f},'mx':{'host':a0_0x2d7803(0x1ff),'min':0x2711,'max':0x4e1f},'br':{'host':a0_0x2d7803(0x1dd),'min':0x4e21,'max':0x752f},'ar':{'host':'ar-pr.oxylabs.io','min':0x7531,'max':0x9c3f},'cl':{'host':'cl-pr.oxylabs.io','min':0x9c41,'max':0xc34f},'pe':{'host':a0_0x2d7803(0x1d7),'min':0x2711,'max':0x4e1f}};router['post'](a0_0x2d7803(0x1e7),async(_0x1bc054,_0x3eecf5)=>{const _0x18c769=a0_0x2d7803,{oxylabsUsername:_0x54eb61,oxylabsPassword:_0x4fce24,country:_0x54d858}=_0x1bc054['body'];if(!_0x54eb61||!_0x4fce24||!_0x54d858)return _0x3eecf5[_0x18c769(0x1ea)](0x190)[_0x18c769(0x1f0)]({'success':![],'message':_0x18c769(0x1ec)});const _0x5469c5=_0x54d858[_0x18c769(0x1e2)](/^([a-z]{2})-pr\.oxylabs\.io/),_0x4c40bf=_0x5469c5?_0x5469c5[0x1]:null;if(!_0x4c40bf||!countryPortRanges[_0x4c40bf])return _0x3eecf5[_0x18c769(0x1ea)](0x190)[_0x18c769(0x1f0)]({'success':![],'message':_0x18c769(0x1d3)});const {host:_0x26bd69,min:_0x19cc57,max:_0x55eab9}=countryPortRanges[_0x4c40bf],_0x1d7f68=Math[_0x18c769(0x1f5)](Math[_0x18c769(0x1da)]()*(_0x55eab9-_0x19cc57+0x1))+_0x19cc57,_0x11881f=_0x26bd69+':'+_0x1d7f68;let _0x4c448c=null;try{_0x4c448c=await getProxyIp(_0x26bd69,_0x1d7f68,_0x54eb61,_0x4fce24);}catch(_0x331646){}return _0x3eecf5[_0x18c769(0x1f0)]({'success':!![],'proxy':_0x11881f,'ip':_0x4c448c});}),module['exports']=router;