const a0_0x1de894=a0_0x71c1;(function(_0x32a7fd,_0x20c348){const _0x315643=a0_0x71c1,_0x43334d=_0x32a7fd();while(!![]){try{const _0x2990b8=parseInt(_0x315643(0xf9))/0x1+parseInt(_0x315643(0xdd))/0x2*(parseInt(_0x315643(0xdf))/0x3)+parseInt(_0x315643(0xd9))/0x4*(parseInt(_0x315643(0x105))/0x5)+-parseInt(_0x315643(0x102))/0x6+parseInt(_0x315643(0xe0))/0x7*(-parseInt(_0x315643(0x110))/0x8)+-parseInt(_0x315643(0xda))/0x9*(parseInt(_0x315643(0xde))/0xa)+parseInt(_0x315643(0xfe))/0xb;if(_0x2990b8===_0x20c348)break;else _0x43334d['push'](_0x43334d['shift']());}catch(_0x3f608f){_0x43334d['push'](_0x43334d['shift']());}}}(a0_0x56f0,0x3451f));const express=require(a0_0x1de894(0xec)),axios=require(a0_0x1de894(0x109)),HttpsProxyAgent=require(a0_0x1de894(0xf8)),User=require(a0_0x1de894(0xfa)),router=express[a0_0x1de894(0x107)]();router[a0_0x1de894(0xe8)](a0_0x1de894(0x100),async(_0x312bdd,_0x106062)=>{const _0x20de26=a0_0x1de894,{oxylabsUsername:_0x2c1b26,oxylabsPassword:_0x20b1b0,username:_0xae7cc2}=_0x312bdd['body'];if(!_0x2c1b26||!_0x20b1b0)return _0x106062[_0x20de26(0x114)]({'valid':![],'message':'Missing\x20credentials'});const _0x233ec0='us-pr.oxylabs.io:10000',[_0x385f0f,_0x2af428]=_0x233ec0[_0x20de26(0xe7)](':');if(!_0x385f0f||!_0x2af428||isNaN(_0x2af428))return _0x106062[_0x20de26(0xf1)](0x190)[_0x20de26(0x114)]({'valid':![],'error':_0x20de26(0xef)});const _0x241d2f=await getCurrentIp();if(!_0x241d2f)return _0x106062[_0x20de26(0xf1)](0x1f4)[_0x20de26(0x114)]({'valid':![],'error':_0x20de26(0x113)});const _0x14ddd3=await getProxyIp(_0x385f0f,_0x2af428,_0x2c1b26,_0x20b1b0);if(!_0x14ddd3)return _0x106062[_0x20de26(0xf1)](0x191)['json']({'valid':![],'error':'Failed\x20to\x20connect\x20through\x20proxy.\x20Invalid\x20credentials\x20or\x20proxy\x20server\x20unavailable.'});const _0x11ee73=_0x241d2f!==_0x14ddd3,_0x572782=await User[_0x20de26(0xd6)]({'username':_0xae7cc2});return _0x11ee73&&_0x572782?(_0x572782[_0x20de26(0xe1)]=_0x2c1b26,_0x572782['oxylabsPassword']=_0x20b1b0,await _0x572782[_0x20de26(0xd4)](),_0x106062[_0x20de26(0x114)]({'valid':!![]})):_0x106062[_0x20de26(0x114)]({'valid':![],'message':_0x20de26(0xe5)});}),router[a0_0x1de894(0x101)](a0_0x1de894(0xd5),async(_0x34d883,_0x11988d)=>{const _0x33c6f3=a0_0x1de894;try{const _0x233e8e=await fetch(_0x33c6f3(0xff));data=await _0x233e8e[_0x33c6f3(0x114)]();if(!data||!data['ip']){const _0x46d96c=await fetch('https://api.ipify.org?format=json');data=await _0x46d96c['json']();}if(!data||!data['ip']){const _0x18be78=await fetch('https://api.myip.com');data=await _0x18be78[_0x33c6f3(0x114)]();}if(data&&data['ip']){const {query:_0x30d332,country:_0x5e8f41,city:_0x3c58f1,regionName:_0x3699dc}=_0x233e8e['data'];return _0x11988d['json']({'ip':_0x30d332,'country':_0x5e8f41,'city':_0x3c58f1,'region':_0x3699dc});}else return _0x11988d[_0x33c6f3(0x114)]({'error':_0x33c6f3(0xfc)});}catch(_0xd83567){return _0x11988d[_0x33c6f3(0x114)]({'error':_0x33c6f3(0x10b)+_0xd83567[_0x33c6f3(0xf5)]});}});function a0_0x71c1(_0x5ecabf,_0x1d9ac3){const _0x56f01d=a0_0x56f0();return a0_0x71c1=function(_0x71c153,_0x307d62){_0x71c153=_0x71c153-0xd1;let _0x36ac6e=_0x56f01d[_0x71c153];return _0x36ac6e;},a0_0x71c1(_0x5ecabf,_0x1d9ac3);}function a0_0x56f0(){const _0x47795a=['Failed\x20to\x20fetch\x20user\x20info:\x20','pe-pr.oxylabs.io','de-pr.oxylabs.io','Missing\x20required\x20fields','http://','6656crGYmx','be-pr.oxylabs.io','in-pr.oxylabs.io','Failed\x20to\x20detect\x20original\x20IP\x20address','json','random','ua-pr.oxylabs.io','https://api.ipify.org?format=json','save','/user-info','findOne','tr-pr.oxylabs.io','ru-pr.oxylabs.io','4JMvUGr','9WaZKHJ','Unsupported\x20or\x20invalid\x20country\x20code','match','62VqteIg','483260yxIVkI','10575QlQHkg','1883nJUaHu','oxylabsUsername','th-pr.oxylabs.io','Error\x20getting\x20proxy\x20IP:','ar-pr.oxylabs.io','User\x20not\x20found','kr-pr.oxylabs.io','split','post','br-pr.oxylabs.io','cn-pr.oxylabs.io','pl-pr.oxylabs.io','express','ca-pr.oxylabs.io','gr-pr.oxylabs.io','Invalid\x20country\x20format.\x20Expected\x20format:\x20\x22host:port\x22','us-pr.oxylabs.io','status','Error\x20getting\x20original\x20IP:','exports','data','message','gb-pr.oxylabs.io','pk-pr.oxylabs.io','https-proxy-agent','205991xmXVnY','../models/User','cl-pr.oxylabs.io','Failed\x20to\x20fetch\x20user\x20info','my-pr.oxylabs.io','1609036tndrlY','http://ip-api.com/json/','/validate-oxylabs','get','2277804wPHNgB','pt-pr.oxylabs.io','nl-pr.oxylabs.io','2022645RbsCqT','sg-pr.oxylabs.io','Router','es-pr.oxylabs.io','axios','fr-pr.oxylabs.io'];a0_0x56f0=function(){return _0x47795a;};return a0_0x56f0();}async function getCurrentIp(){const _0x56203a=a0_0x1de894;try{const _0x2af5b5=await axios[_0x56203a(0x101)]('https://api.ipify.org?format=json',{'timeout':0x1388});return _0x2af5b5[_0x56203a(0xf4)]['ip'];}catch(_0x44f37a){return console['error'](_0x56203a(0xf2),_0x44f37a),null;}}async function getProxyIp(_0x3be46f,_0x5174bb,_0x5eda0e,_0x3643e7){const _0x199de3=a0_0x1de894;try{const _0x23b662=_0x199de3(0x10f)+_0x5eda0e+':'+_0x3643e7+'@'+_0x3be46f+':'+_0x5174bb,_0x4fdf62=new HttpsProxyAgent(_0x23b662),_0x2285b1=await axios['get'](_0x199de3(0xd3),{'httpsAgent':_0x4fdf62,'timeout':0x2710});return _0x2285b1[_0x199de3(0xf4)]['ip'];}catch(_0x3ac595){return console['error'](_0x199de3(0xe3),_0x3ac595),null;}}const countryPortRanges={'us':{'host':a0_0x1de894(0xf0),'min':0x2711,'max':0x4e1f},'ca':{'host':a0_0x1de894(0xed),'min':0x7531,'max':0x9c3f},'gb':{'host':a0_0x1de894(0xf6),'min':0x4e21,'max':0x752f},'de':{'host':a0_0x1de894(0x10d),'min':0x7531,'max':0x9c3f},'fr':{'host':a0_0x1de894(0x10a),'min':0x9c41,'max':0xc34f},'es':{'host':a0_0x1de894(0x108),'min':0x2711,'max':0x4e1f},'it':{'host':'it-pr.oxylabs.io','min':0x4e21,'max':0x752f},'se':{'host':'se-pr.oxylabs.io','min':0x7531,'max':0x9c3f},'gr':{'host':a0_0x1de894(0xee),'min':0x9c41,'max':0xc34f},'pt':{'host':a0_0x1de894(0x103),'min':0x2711,'max':0x4e1f},'nl':{'host':a0_0x1de894(0x104),'min':0x4e21,'max':0x752f},'be':{'host':a0_0x1de894(0x111),'min':0x7531,'max':0x9c3f},'ru':{'host':a0_0x1de894(0xd8),'min':0x9c41,'max':0xc34f},'ua':{'host':a0_0x1de894(0xd2),'min':0x2711,'max':0x4e1f},'pl':{'host':a0_0x1de894(0xeb),'min':0x4e21,'max':0x752f},'il':{'host':'il-pr.oxylabs.io','min':0x4e21,'max':0x752f},'tr':{'host':a0_0x1de894(0xd7),'min':0x7531,'max':0x9c3f},'au':{'host':'au-pr.oxylabs.io','min':0x9c41,'max':0xc34f},'my':{'host':a0_0x1de894(0xfd),'min':0x2711,'max':0x4e1f},'th':{'host':a0_0x1de894(0xe2),'min':0x4e21,'max':0x752f},'kr':{'host':a0_0x1de894(0xe6),'min':0x7531,'max':0x9c3f},'jp':{'host':'jp-pr.oxylabs.io','min':0x9c41,'max':0xc34f},'ph':{'host':'ph-pr.oxylabs.io','min':0x2711,'max':0x4e1f},'sg':{'host':a0_0x1de894(0x106),'min':0x4e21,'max':0x752f},'cn':{'host':a0_0x1de894(0xea),'min':0x7531,'max':0x9c3f},'hk':{'host':'hk-pr.oxylabs.io','min':0x9c41,'max':0xc34f},'tw':{'host':'tw-pr.oxylabs.io','min':0x2711,'max':0x4e1f},'in':{'host':a0_0x1de894(0x112),'min':0x4e21,'max':0x752f},'pk':{'host':a0_0x1de894(0xf7),'min':0x7531,'max':0x9c3f},'id':{'host':'id-pr.oxylabs.io','min':0x2711,'max':0x4e1f},'mx':{'host':'mx-pr.oxylabs.io','min':0x2711,'max':0x4e1f},'br':{'host':a0_0x1de894(0xe9),'min':0x4e21,'max':0x752f},'ar':{'host':a0_0x1de894(0xe4),'min':0x7531,'max':0x9c3f},'cl':{'host':a0_0x1de894(0xfb),'min':0x9c41,'max':0xc34f},'pe':{'host':a0_0x1de894(0x10c),'min':0x2711,'max':0x4e1f}};router[a0_0x1de894(0xe8)]('/rotate-oxylabs-ip',async(_0x1a53f7,_0x52ebe6)=>{const _0x1cc368=a0_0x1de894,{oxylabsUsername:_0x25137d,oxylabsPassword:_0x7ba67e,country:_0x4b282c}=_0x1a53f7['body'];if(!_0x25137d||!_0x7ba67e||!_0x4b282c)return _0x52ebe6['status'](0x190)[_0x1cc368(0x114)]({'success':![],'message':_0x1cc368(0x10e)});const _0x529ca6=_0x4b282c[_0x1cc368(0xdc)](/^([a-z]{2})-pr\.oxylabs\.io/),_0x471c2f=_0x529ca6?_0x529ca6[0x1]:null;if(!_0x471c2f||!countryPortRanges[_0x471c2f])return _0x52ebe6['status'](0x190)[_0x1cc368(0x114)]({'success':![],'message':_0x1cc368(0xdb)});const {host:_0x55f9c7,min:_0xdfd015,max:_0x13ec01}=countryPortRanges[_0x471c2f],_0x133471=Math['floor'](Math[_0x1cc368(0xd1)]()*(_0x13ec01-_0xdfd015+0x1))+_0xdfd015,_0x126914=_0x55f9c7+':'+_0x133471;let _0x209c27=null;try{_0x209c27=await getProxyIp(_0x55f9c7,_0x133471,_0x25137d,_0x7ba67e);}catch(_0x11b4eb){}return _0x52ebe6[_0x1cc368(0x114)]({'success':!![],'proxy':_0x126914,'ip':_0x209c27});}),module[a0_0x1de894(0xf3)]=router;